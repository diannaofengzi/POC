# CVE-2019-11043

null

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/ianxtianxt](https://github.com/ianxtianxt) |
| Url      | [https://github.com/ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)                                               |
| Stars    | 1                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2019-11043
漏洞描述

NgiNginx 上 fastcgi_split_path_info 在处理带有 %0a 的请求时，会因为遇到换行符 \n 导致 PATH_INFO 为空。而 php-fpm 在处理 PATH_INFO 为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。
nx 上 fastcgi_split_path_info 在处理带有 %0a 的请求时，会因为遇到换行符 \n 导致 PATH_INFO 为空。而 php-fpm 在处理 PATH_INFO 为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。

影响范围

Nginx + php-fpm 的服务器，在使用如下配置的情况下，都可能存在远程代码执行漏洞。

 location ~ [^/]\.php(/|$) {
        fastcgi_split_path_info ^(.+?\.php)(/.*)$;
        fastcgi_param PATH_INFO       $fastcgi_path_info;
        fastcgi_pass   php:9000;
        ...
  }
}

解决方案

在不影响正常业务的情况下，删除 Nginx 配置文件中的如下配置：
 
fastcgi_split_path_info ^(.+?\.php)(/.*)$;
fastcgi_param PATH_INFO       $fastcgi_path_info;



内涵两个exp一个是go语言，另一个是编译好的exp

./phuip-fpizdam http://192.168.93.131:8080/index.php



## Get the content

```
git clone https://github.com/ianxtianxt/CVE-2019-11043
cd CVE-2019-11043
```

{% embed url="https://github.com/ianxtianxt/CVE-2019-11043" %}

<figure><img src="https://avatars.githubusercontent.com/u/45796484?v=4" alt=""><figcaption><p>ianxtianxt</p></figcaption></figure>
