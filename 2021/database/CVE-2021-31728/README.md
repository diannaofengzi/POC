# CVE-2021-31728

Incorrect access control in zam64.sys, zam32.sys in MalwareFox AntiMalware 2.74.0.150 allows a non-privileged process to open a handle to \.\ZemanaAntiMalware, register itself with the driver by sending IOCTL 0x80002010, allocate executable memory using a flaw in IOCTL 0x80002040, install a hook with IOCTL 0x80002044 and execute the executable memory using this hook with IOCTL 0x80002014 or 0x80002018, this exposes ring 0 code execution in the context of the driver allowing the non-privileged process to elevate privileges.

{% embed url="https://github.com/Live-Hack-CVE/full_database/blob/main/cves/2021/CVE-2021-31728.json" %}


* hfiref0x ~> [KDU](https://zeste.alice-snow.ru/2021/database/cve-2021-31728/kdu-hfiref0x)